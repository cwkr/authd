<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ .title }}</title>
    <link rel="stylesheet" href="{{ .base_path }}/style.css">
    <link rel="icon" type="image/png" href="{{ .base_path }}/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="{{ .base_path }}/favicon-32x32.png" sizes="32x32">
    <script src="{{ .base_path }}/scripts/main.js" type="module"></script>
</head>
<body>
<div style="display: flex; flex-direction: row; align-items: baseline; gap: 1em;">
    <h1>{{ .title }}</h1>
    {{- if .current_session.UserID }}
    <strong style="margin-left: auto;" title="Authenticated {{ .current_session.CreatedAt }}&#10;Verified {{ if .current_session.VerifiedAt.IsZero }}no{{ else }}{{ .current_session.VerifiedAt }}{{ end }}&#10;Session expires {{ .current_session.ExpiresAt }}">{{ .current_session.UserID }}</strong>
    <form method="get" action="{{ .base_path }}/logout">
        <input type="hidden" name="post_logout_redirect_uri" value="{{ .issuer }}/">
        <button type="submit">Logout</button>
    </form>
    {{- end }}
</div>

<div>
    <a href="{{ .base_path }}/.well-known/openid-configuration">OpenID Connect discovery document</a>
</div>

<h2>Public Key</h2>
<div>
    <a href="{{ .base_path }}/jwks">JSON Web Key Set</a>
</div>
<pre><code>{{ .public_key }}</code></pre>

<h2>Token Request</h2>
<form method="get" action="{{ .base_path }}/authorize" id="request_form">
    <input type="hidden" name="redirect_uri" value="{{ .issuer }}/">
    <input type="hidden" id="state" name="state" value="{{ .state }}">
    <input type="hidden" id="nonce" name="nonce" value="{{ .nonce }}">
    <input type="hidden" id="code_verifier" name="code_verifier" value="{{ .code_verifier }}" disabled>
    <input type="hidden" id="code_challenge" name="code_challenge" value="{{ .code_challenge }}" disabled>
    <input type="hidden" id="code_challenge_method" name="code_challenge_method" value="S256" disabled>
    <input type="hidden" id="scope" name="scope">
    <label for="response_type">Flow</label>
    <select id="response_type" name="response_type" required>
        <option value="">&mdash;</option>
        <option value="token">Implicit</option>
        <option value="code">Authorization Code</option>
        <option value="client_credentials">Client Credentials</option>
        <option value="password">Password</option>
        <option value="refresh_token">Refresh Token</option>
    </select>
    <label for="client_id">Client</label>
    <select id="client_id" name="client_id" required>
        <option value="">&mdash;</option>
    {{- range .client_ids }}
        <option value="{{ . }}">{{ . }}</option>
    {{- end }}
    </select>
    <label for="client_secret">Client Secret</label>
    <input type="password" id="client_secret" required disabled>
    <label for="username">Username</label>
    <input type="text" id="username" required disabled>
    <label for="password">Password</label>
    <input type="password" id="password" required disabled>
    <label for="txa_token">Token</label>
    <textarea id="txa_token" required disabled></textarea>
    <details>
        <summary>Scope</summary>
        {{- range .scopes }}
        <div style="margin-right: .5em">
            <input type="checkbox" id="scope_{{ . }}" value="{{ . }}">
            <label for="scope_{{ . }}">{{ . }}</label>
        </div>
        {{- end }}
    </details>
    <button type="submit">Get token</button>
</form>
<div id="access_token_panel" style="display: none;">
    <h3>Access token</h3>
    <pre style="white-space: pre-wrap; word-wrap: break-word;"><code id="access_token_output"></code></pre>
    <pre style="white-space: pre-wrap; word-wrap: break-word;"><code id="access_token_json"></code></pre>
</div>
<div id="id_token_panel" style="display: none;">
    <h3>Id token</h3>
    <pre style="white-space: pre-wrap; word-wrap: break-word;"><code id="id_token_output"></code></pre>
    <pre style="white-space: pre-wrap; word-wrap: break-word;"><code id="id_token_json"></code></pre>
</div>
<div id="refresh_token_panel" style="display: none;">
    <h3>Refresh token</h3>
    <pre style="white-space: pre-wrap; word-wrap: break-word;"><code id="refresh_token_output"></code></pre>
</div>

<div style="text-align: right"><small>{{ .version }}</small></div>
</body>
</html>
